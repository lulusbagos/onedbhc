@model one_db.Models.vw_m_surat_pengajuan
@using System.IO
@{
    Layout = null;
    Func<DateTime?, string> FormatDate = dt => dt.HasValue ? dt.Value.ToString("yyyy-MM-dd") : "";
    var qrPemohonUri = ViewData["PernikahanQrPemohonUri"] as string;
    var qrAtasanUri = ViewData["PernikahanQrAtasanUri"] as string;
}

<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Formulir Pengajuan Hadiah Pernikahan - @Model.nama_lengkap</title>
    <style>
        @Html.Raw("@page { size: A4; margin: 0; }")
        body{ margin:0; padding:0; background:#525659; display:flex; justify-content:center; font-family: Arial, Helvetica, sans-serif; }
        .page{ width:210mm; min-height:297mm; padding:15mm; box-sizing:border-box; background:#fff; }
        .main-container{ border:2px solid #000; padding:15px; min-height:260mm; box-sizing:border-box; position:relative; }
        .header-bar{ background:#000; color:#fff; font-weight:700; padding:6px; margin-bottom:12px; text-align:center; }
        .main-title{ font-size:13pt; text-transform:uppercase; }
        .intro{ margin-bottom:12px; line-height:1.3; font-size:10pt; }
        .input-table{ width:100%; border-collapse:separate; border-spacing:0 6px; }
        .input-table td{ vertical-align:middle; }
        .label-col{ width:150px; font-size:10pt; }
        .sep-col{ width:10px; text-align:center; }
        .input-box{ border:1px solid #000; height:22px; width:100%; background:#fff; }
        .section-title{ font-size:11pt; margin-top:12px; padding-left:6px; background:#000; color:#fff; display:inline-block; padding:4px 8px; }
        .ketentuan-list{ list-style-type: lower-alpha; padding-left:20px; margin:8px 0; }
        .review-content{ margin-top:8px; padding-left:6px; }
        .sig-table{ width:100%; border-collapse:collapse; border:1px solid #000; margin-top:20px; }
        .sig-table td{ border:1px solid #000; padding:6px; vertical-align:top; }
        .sig-cell-header{ text-align:center; font-weight:700; padding:6px; }
        .sig-cell-space{ height:60px; }
        .tembusan{ margin-top:20px; font-size:10pt; }
        .tembusan ul{ list-style:none; padding-left:10px; }
        .tembusan li:before{ content: '- '; }

        @@media print{
            body{ background:none; }
            .page{ width:100%; padding:0; margin:0; }
            .main-container{ min-height:98vh; border:2px solid #000; }
        }
    </style>
</head>
<body>
    <div class="page">
        <div class="main-container">
            <div class="header-bar main-title">FORMULIR PENGAJUAN HADIAH PERNIKAHAN KARYAWAN</div>

            <div class="intro">Dengan ini kami mohon persetujuan Manajemen untuk memberikan hadiah pernikahan kepada Karyawan dengan data sebagai berikut :</div>

            <table class="input-table">
                <tr>
                    <td class="label-col">Nama</td>
                    <td class="sep-col">:</td>
                    <td><div class="input-box">@Model.nama_lengkap</div></td>
                </tr>
                <tr>
                    <td class="label-col">NIK</td>
                    <td class="sep-col">:</td>
                    <td><div class="input-box">@Model.nik</div></td>
                </tr>
                <tr>
                    <td class="label-col">Status Kerja</td>
                    <td class="sep-col">:</td>
                    <td><div class="input-box">Karyawan Tetap</div></td>
                </tr>
                <tr>
                    <td class="label-col">Departemen</td>
                    <td class="sep-col">:</td>
                    <td><div class="input-box">@Model.depart</div></td>
                </tr>
                <tr>
                    <td class="label-col">Jabatan</td>
                    <td class="sep-col">:</td>
                    <td><div class="input-box">@Model.posisi</div></td>
                </tr>
                <tr>
                    <td class="label-col">Tanggal Menikah</td>
                    <td class="sep-col">:</td>
                    <td><div class="input-box">@FormatDate(Model.tgl_menikah)</div></td>
                </tr>
            </table>

            <div class="section-title">Ketentuan :</div>
            <ol class="ketentuan-list">
                <li>Hadiah pernikahan diberikan untuk pernikahan sah yang pertama Karyawan tersebut</li>
                <li>Pengajuan klaim paling lama 3 (tiga) bulan dari tanggal menikah</li>
                <li>Pengajuan hadiah pernikahan dari perusahaan mining, cukup dengan melengkapi (foto copy surat nikah/buku nikah dan KTP pasangan Suami & Istri)</li>
            </ol>

            <div class="section-title">Review HC :</div>
            <div class="review-content">
                <table class="input-table">
                    <tr>
                        <td class="label-col" style="width:200px;">Permohonan diterima HC tanggal</td>
                        <td class="sep-col">:</td>
                        <td><div class="input-box">@FormatDate(Model.tanggal_pengajuan)</div></td>
                    </tr>
                    <tr>
                        <td class="label-col">Pernah Klaim</td>
                        <td class="sep-col">:</td>
                        <td>@(Model.pernah_klaim_pernikahan == "true" ? "Pernah" : "Tidak")</td>
                    </tr>
                    <tr>
                        <td class="label-col">Nama Pasangan</td>
                        <td class="sep-col">:</td>
                        <td><div class="input-box">@Model.nama_pasangan</div></td>
                    </tr>
                </table>
            </div>

            <p style="margin-top:12px;">Demikian pengajuan hadiah pernikahan karyawan sesuai data dan ketentuan di atas :</p>

            <table class="sig-table">
                <tr>
                    <td style="width:35%;">
                        <div class="sig-cell-header">Pemohon</div>
                        <div style="text-align:center; padding:6px;">
                            @if (!string.IsNullOrEmpty(qrPemohonUri))
                            {
                                <img src="@qrPemohonUri" alt="QR Pemohon" style="width:100px;height:100px;object-fit:contain;" />
                            }
                        </div>
                    </td>
                    <td style="width:35%;">
                        <div class="sig-cell-header">Persetujuan Atasan</div>
                        <div style="text-align:center; padding:6px;">
                            @if (!string.IsNullOrEmpty(qrAtasanUri))
                            {
                                <img src="@qrAtasanUri" alt="QR Atasan" style="width:100px;height:100px;object-fit:contain;" />
                            }
                        </div>
                    </td>
                    <td rowspan="2" style="width:30%; padding:6px;">
                        <strong>Catatan :</strong>
                        <div style="margin-top:6px; min-height:120px;">@Model.remarks</div>
                    </td>
                </tr>
                <tr>
                    <td style="text-align:center; font-weight:700;">HC</td>
                    <td style="text-align:center; font-weight:700;">HCGS Manager</td>
                </tr>
            </table>

            <div class="tembusan">
                Tembusan:
                <ul>
                    <li>HCGS Manager</li>
                    <li>Finance &amp; Accounting</li>
                </ul>
            </div>

        </div>
    </div>
</body>
</html>

